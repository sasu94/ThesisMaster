<!DOCTYPE>
<html>
<head>
  <title>
    Topology
  </title>
<style type="text/css">
    #container {
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      position: absolute;
    }

</style>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
<div id="container"></div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
<script src="../src/sigma.min.js"></script>
<script src="../src/plugins/sigma.parsers.json.min.js"></script>
<script src="../src/plugins/sigma.plugins.dragNodes.min.js"></script>
<script src="../src/plugins/sigma.renderers.edgeLabels.min.js"></script>
<script>
  
  
  var s=sigma.parsers.json('data.json', {
    renderer: {              
        container: 'container',
        type: 'canvas'
    },
    settings: {
      defaultNodeColor: '#ec5148',
      edgeLabelSize: 'proportional'
    } },
    function(s) {
      
      
      function click(e){
        var l=s.graph.edges().filter(function(edge){
          
          if(edge.source==e.data.node.id){
              edge.isSource=true;
              return true
          }else if(edge.target==e.data.node.id){
              edge.isSource=false;
              return true;
          }return  false;
        });
        
        
        var res='IP='+e.data.node.id+'<br>MAC='+e.data.node.mac+'<br><br><table class="table"><thead><tr><th scope="col">Name</th><th scope="col">IP</th><th scope="col">MAC</th><th scope="col">From</th><th scope="col">To</th></tr></thead><tbody>';
        
        l.forEach(function(f){
          res+='<tr>';
          if(f.isSource){
            var target=s.graph.nodes().filter(function(node){
                return node.id==f.target;
            });
            res+='<td>'+target[0].label+'</td><td>'+f.target+'</td><td>'+target[0].mac+'</td>';
          }else{
            var source=s.graph.nodes().filter(function(node){
                return node.id==f.source;
            });
            
            res+='<td>'+source[0].label+'</td><td>'+f.source+'</td><td>'+source[0].mac+'</td>';
          }
          res+='<td>'+f.from+'</td><td>'+f.to+'</td></tr>';     
        })
          
        res+='</tbody></table>'
        Swal.fire({
          html: res,
          title: 'links detail for '+e.data.node.label,
          confirmButtonText: 'OK',
          width: '60%'
        })
      }      
      
      
      
      s.bind('clickNode',click);
      s.graph.nodes().forEach(function(node, i, a) {
        node.x = Math.cos(Math.PI * 2 * i / a.length);
        node.y = Math.sin(Math.PI * 2 * i / a.length);
      });
      var dragListener = sigma.plugins.dragNodes(s, s.renderers[0]);
            
      dragListener.bind('drag',function(){
         setTimeout(function () {
             s.unbind('clickNode');
         });
       });
           
      dragListener.bind('dragend',function(){
        setTimeout(function(){
          s.bind('clickNode', click);
        },250)
      });
      
      s.refresh();
            
  });
  
  console.log(s);
  
</script>
</body>
</html>
